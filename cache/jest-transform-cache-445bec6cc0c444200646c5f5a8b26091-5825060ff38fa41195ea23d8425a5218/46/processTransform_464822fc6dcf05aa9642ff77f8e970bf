be490ab8151df0ea601589380d09200c
'use strict';

var MatrixMath = require("../Utilities/MatrixMath");
var Platform = require("../Utilities/Platform");
var invariant = require('invariant');
var stringifySafe = require("../Utilities/stringifySafe")["default"];
function processTransform(transform) {
  if (__DEV__) {
    _validateTransforms(transform);
  }
  if (Platform.OS === 'android' || Platform.OS === 'ios') {
    return transform;
  }
  var result = MatrixMath.createIdentityMatrix();
  transform.forEach(function (transformation) {
    var key = Object.keys(transformation)[0];
    var value = transformation[key];
    switch (key) {
      case 'matrix':
        MatrixMath.multiplyInto(result, result, value);
        break;
      case 'perspective':
        _multiplyTransform(result, MatrixMath.reusePerspectiveCommand, [value]);
        break;
      case 'rotateX':
        _multiplyTransform(result, MatrixMath.reuseRotateXCommand, [_convertToRadians(value)]);
        break;
      case 'rotateY':
        _multiplyTransform(result, MatrixMath.reuseRotateYCommand, [_convertToRadians(value)]);
        break;
      case 'rotate':
      case 'rotateZ':
        _multiplyTransform(result, MatrixMath.reuseRotateZCommand, [_convertToRadians(value)]);
        break;
      case 'scale':
        _multiplyTransform(result, MatrixMath.reuseScaleCommand, [value]);
        break;
      case 'scaleX':
        _multiplyTransform(result, MatrixMath.reuseScaleXCommand, [value]);
        break;
      case 'scaleY':
        _multiplyTransform(result, MatrixMath.reuseScaleYCommand, [value]);
        break;
      case 'translate':
        _multiplyTransform(result, MatrixMath.reuseTranslate3dCommand, [value[0], value[1], value[2] || 0]);
        break;
      case 'translateX':
        _multiplyTransform(result, MatrixMath.reuseTranslate2dCommand, [value, 0]);
        break;
      case 'translateY':
        _multiplyTransform(result, MatrixMath.reuseTranslate2dCommand, [0, value]);
        break;
      case 'skewX':
        _multiplyTransform(result, MatrixMath.reuseSkewXCommand, [_convertToRadians(value)]);
        break;
      case 'skewY':
        _multiplyTransform(result, MatrixMath.reuseSkewYCommand, [_convertToRadians(value)]);
        break;
      default:
        throw new Error('Invalid transform name: ' + key);
    }
  });
  return result;
}
function _multiplyTransform(result, matrixMathFunction, args) {
  var matrixToApply = MatrixMath.createIdentityMatrix();
  var argsWithIdentity = [matrixToApply].concat(args);
  matrixMathFunction.apply(this, argsWithIdentity);
  MatrixMath.multiplyInto(result, result, matrixToApply);
}
function _convertToRadians(value) {
  var floatValue = parseFloat(value);
  return value.indexOf('rad') > -1 ? floatValue : floatValue * Math.PI / 180;
}
function _validateTransforms(transform) {
  transform.forEach(function (transformation) {
    var keys = Object.keys(transformation);
    invariant(keys.length === 1, 'You must specify exactly one property per transform object. Passed properties: %s', stringifySafe(transformation));
    var key = keys[0];
    var value = transformation[key];
    _validateTransform(key, value, transformation);
  });
}
function _validateTransform(key, value, transformation) {
  invariant(!value.getValue, 'You passed an Animated.Value to a normal component. ' + 'You need to wrap that component in an Animated. For example, ' + 'replace <View /> by <Animated.View />.');
  var multivalueTransforms = ['matrix', 'translate'];
  if (multivalueTransforms.indexOf(key) !== -1) {
    invariant(Array.isArray(value), 'Transform with key of %s must have an array as the value: %s', key, stringifySafe(transformation));
  }
  switch (key) {
    case 'matrix':
      invariant(value.length === 9 || value.length === 16, 'Matrix transform must have a length of 9 (2d) or 16 (3d). ' + 'Provided matrix has a length of %s: %s', value.length, stringifySafe(transformation));
      break;
    case 'translate':
      invariant(value.length === 2 || value.length === 3, 'Transform with key translate must be an array of length 2 or 3, found %s: %s', value.length, stringifySafe(transformation));
      break;
    case 'rotateX':
    case 'rotateY':
    case 'rotateZ':
    case 'rotate':
    case 'skewX':
    case 'skewY':
      invariant(typeof value === 'string', 'Transform with key of "%s" must be a string: %s', key, stringifySafe(transformation));
      invariant(value.indexOf('deg') > -1 || value.indexOf('rad') > -1, 'Rotate transform must be expressed in degrees (deg) or radians ' + '(rad): %s', stringifySafe(transformation));
      break;
    case 'perspective':
      invariant(typeof value === 'number', 'Transform with key of "%s" must be a number: %s', key, stringifySafe(transformation));
      invariant(value !== 0, 'Transform with key of "%s" cannot be zero: %s', key, stringifySafe(transformation));
      break;
    case 'translateX':
    case 'translateY':
    case 'scale':
    case 'scaleX':
    case 'scaleY':
      invariant(typeof value === 'number', 'Transform with key of "%s" must be a number: %s', key, stringifySafe(transformation));
      break;
    default:
      invariant(false, 'Invalid transform %s: %s', key, stringifySafe(transformation));
  }
}
module.exports = processTransform;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNYXRyaXhNYXRoIiwicmVxdWlyZSIsIlBsYXRmb3JtIiwiaW52YXJpYW50Iiwic3RyaW5naWZ5U2FmZSIsInByb2Nlc3NUcmFuc2Zvcm0iLCJ0cmFuc2Zvcm0iLCJfX0RFVl9fIiwiX3ZhbGlkYXRlVHJhbnNmb3JtcyIsIk9TIiwicmVzdWx0IiwiY3JlYXRlSWRlbnRpdHlNYXRyaXgiLCJmb3JFYWNoIiwidHJhbnNmb3JtYXRpb24iLCJrZXkiLCJPYmplY3QiLCJrZXlzIiwidmFsdWUiLCJtdWx0aXBseUludG8iLCJfbXVsdGlwbHlUcmFuc2Zvcm0iLCJyZXVzZVBlcnNwZWN0aXZlQ29tbWFuZCIsInJldXNlUm90YXRlWENvbW1hbmQiLCJfY29udmVydFRvUmFkaWFucyIsInJldXNlUm90YXRlWUNvbW1hbmQiLCJyZXVzZVJvdGF0ZVpDb21tYW5kIiwicmV1c2VTY2FsZUNvbW1hbmQiLCJyZXVzZVNjYWxlWENvbW1hbmQiLCJyZXVzZVNjYWxlWUNvbW1hbmQiLCJyZXVzZVRyYW5zbGF0ZTNkQ29tbWFuZCIsInJldXNlVHJhbnNsYXRlMmRDb21tYW5kIiwicmV1c2VTa2V3WENvbW1hbmQiLCJyZXVzZVNrZXdZQ29tbWFuZCIsIkVycm9yIiwibWF0cml4TWF0aEZ1bmN0aW9uIiwiYXJncyIsIm1hdHJpeFRvQXBwbHkiLCJhcmdzV2l0aElkZW50aXR5IiwiY29uY2F0IiwiYXBwbHkiLCJmbG9hdFZhbHVlIiwicGFyc2VGbG9hdCIsImluZGV4T2YiLCJNYXRoIiwiUEkiLCJsZW5ndGgiLCJfdmFsaWRhdGVUcmFuc2Zvcm0iLCJnZXRWYWx1ZSIsIm11bHRpdmFsdWVUcmFuc2Zvcm1zIiwiQXJyYXkiLCJpc0FycmF5IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInByb2Nlc3NUcmFuc2Zvcm0uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE1ldGEgUGxhdGZvcm1zLCBJbmMuIGFuZCBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmb3JtYXRcbiAqIEBmbG93XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBNYXRyaXhNYXRoID0gcmVxdWlyZSgnLi4vVXRpbGl0aWVzL01hdHJpeE1hdGgnKTtcbmNvbnN0IFBsYXRmb3JtID0gcmVxdWlyZSgnLi4vVXRpbGl0aWVzL1BsYXRmb3JtJyk7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ludmFyaWFudCcpO1xuY29uc3Qgc3RyaW5naWZ5U2FmZSA9IHJlcXVpcmUoJy4uL1V0aWxpdGllcy9zdHJpbmdpZnlTYWZlJykuZGVmYXVsdDtcblxuLyoqXG4gKiBHZW5lcmF0ZSBhIHRyYW5zZm9ybSBtYXRyaXggYmFzZWQgb24gdGhlIHByb3ZpZGVkIHRyYW5zZm9ybXMsIGFuZCB1c2UgdGhhdFxuICogd2l0aGluIHRoZSBzdHlsZSBvYmplY3QgaW5zdGVhZC5cbiAqXG4gKiBUaGlzIGFsbG93cyB1cyB0byBwcm92aWRlIGFuIEFQSSB0aGF0IGlzIHNpbWlsYXIgdG8gQ1NTLCB3aGVyZSB0cmFuc2Zvcm1zIG1heVxuICogYmUgYXBwbGllZCBpbiBhbiBhcmJpdHJhcnkgb3JkZXIsIGFuZCB5ZXQgaGF2ZSBhIHVuaXZlcnNhbCwgc2luZ3VsYXJcbiAqIGludGVyZmFjZSB0byBuYXRpdmUgY29kZS5cbiAqL1xuZnVuY3Rpb24gcHJvY2Vzc1RyYW5zZm9ybShcbiAgdHJhbnNmb3JtOiBBcnJheTxPYmplY3Q+LFxuKTogQXJyYXk8T2JqZWN0PiB8IEFycmF5PG51bWJlcj4ge1xuICBpZiAoX19ERVZfXykge1xuICAgIF92YWxpZGF0ZVRyYW5zZm9ybXModHJhbnNmb3JtKTtcbiAgfVxuXG4gIC8vIEFuZHJvaWQgJiBpT1MgaW1wbGVtZW50YXRpb25zIG9mIHRyYW5zZm9ybSBwcm9wZXJ0eSBhY2NlcHQgdGhlIGxpc3Qgb2ZcbiAgLy8gdHJhbnNmb3JtIHByb3BlcnRpZXMgYXMgb3Bwb3NlZCB0byBhIHRyYW5zZm9ybSBNYXRyaXguIFRoaXMgaXMgbmVjZXNzYXJ5XG4gIC8vIHRvIGNvbnRyb2wgdHJhbnNmb3JtIHByb3BlcnR5IHVwZGF0ZXMgY29tcGxldGVseSBvbiB0aGUgbmF0aXZlIHRocmVhZC5cbiAgaWYgKFBsYXRmb3JtLk9TID09PSAnYW5kcm9pZCcgfHwgUGxhdGZvcm0uT1MgPT09ICdpb3MnKSB7XG4gICAgcmV0dXJuIHRyYW5zZm9ybTtcbiAgfVxuXG4gIGNvbnN0IHJlc3VsdCA9IE1hdHJpeE1hdGguY3JlYXRlSWRlbnRpdHlNYXRyaXgoKTtcblxuICB0cmFuc2Zvcm0uZm9yRWFjaCh0cmFuc2Zvcm1hdGlvbiA9PiB7XG4gICAgY29uc3Qga2V5ID0gT2JqZWN0LmtleXModHJhbnNmb3JtYXRpb24pWzBdO1xuICAgIGNvbnN0IHZhbHVlID0gdHJhbnNmb3JtYXRpb25ba2V5XTtcblxuICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICBjYXNlICdtYXRyaXgnOlxuICAgICAgICBNYXRyaXhNYXRoLm11bHRpcGx5SW50byhyZXN1bHQsIHJlc3VsdCwgdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3BlcnNwZWN0aXZlJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVBlcnNwZWN0aXZlQ29tbWFuZCwgW3ZhbHVlXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncm90YXRlWCc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VSb3RhdGVYQ29tbWFuZCwgW1xuICAgICAgICAgIF9jb252ZXJ0VG9SYWRpYW5zKHZhbHVlKSxcbiAgICAgICAgXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncm90YXRlWSc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VSb3RhdGVZQ29tbWFuZCwgW1xuICAgICAgICAgIF9jb252ZXJ0VG9SYWRpYW5zKHZhbHVlKSxcbiAgICAgICAgXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncm90YXRlJzpcbiAgICAgIGNhc2UgJ3JvdGF0ZVonOlxuICAgICAgICBfbXVsdGlwbHlUcmFuc2Zvcm0ocmVzdWx0LCBNYXRyaXhNYXRoLnJldXNlUm90YXRlWkNvbW1hbmQsIFtcbiAgICAgICAgICBfY29udmVydFRvUmFkaWFucyh2YWx1ZSksXG4gICAgICAgIF0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3NjYWxlJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVNjYWxlQ29tbWFuZCwgW3ZhbHVlXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc2NhbGVYJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVNjYWxlWENvbW1hbmQsIFt2YWx1ZV0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3NjYWxlWSc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VTY2FsZVlDb21tYW5kLCBbdmFsdWVdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd0cmFuc2xhdGUnOlxuICAgICAgICBfbXVsdGlwbHlUcmFuc2Zvcm0ocmVzdWx0LCBNYXRyaXhNYXRoLnJldXNlVHJhbnNsYXRlM2RDb21tYW5kLCBbXG4gICAgICAgICAgdmFsdWVbMF0sXG4gICAgICAgICAgdmFsdWVbMV0sXG4gICAgICAgICAgdmFsdWVbMl0gfHwgMCxcbiAgICAgICAgXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndHJhbnNsYXRlWCc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VUcmFuc2xhdGUyZENvbW1hbmQsIFtcbiAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAwLFxuICAgICAgICBdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd0cmFuc2xhdGVZJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVRyYW5zbGF0ZTJkQ29tbWFuZCwgW1xuICAgICAgICAgIDAsXG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgIF0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3NrZXdYJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVNrZXdYQ29tbWFuZCwgW1xuICAgICAgICAgIF9jb252ZXJ0VG9SYWRpYW5zKHZhbHVlKSxcbiAgICAgICAgXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc2tld1knOlxuICAgICAgICBfbXVsdGlwbHlUcmFuc2Zvcm0ocmVzdWx0LCBNYXRyaXhNYXRoLnJldXNlU2tld1lDb21tYW5kLCBbXG4gICAgICAgICAgX2NvbnZlcnRUb1JhZGlhbnModmFsdWUpLFxuICAgICAgICBdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdHJhbnNmb3JtIG5hbWU6ICcgKyBrZXkpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBQZXJmb3JtcyBhIGRlc3RydWN0aXZlIG9wZXJhdGlvbiBvbiBhIHRyYW5zZm9ybSBtYXRyaXguXG4gKi9cbi8qICRGbG93Rml4TWVbbWlzc2luZy10aGlzLWFubm90XSBUaGUgJ3RoaXMnIHR5cGUgYW5ub3RhdGlvbihzKSByZXF1aXJlZCBieVxuICogRmxvdydzIExUSSB1cGRhdGUgY291bGQgbm90IGJlIGFkZGVkIHZpYSBjb2RlbW9kICovXG5mdW5jdGlvbiBfbXVsdGlwbHlUcmFuc2Zvcm0oXG4gIHJlc3VsdDogQXJyYXk8bnVtYmVyPixcbiAgbWF0cml4TWF0aEZ1bmN0aW9uOiBGdW5jdGlvbixcbiAgYXJnczogQXJyYXk8bnVtYmVyPixcbik6IHZvaWQge1xuICBjb25zdCBtYXRyaXhUb0FwcGx5ID0gTWF0cml4TWF0aC5jcmVhdGVJZGVudGl0eU1hdHJpeCgpO1xuICBjb25zdCBhcmdzV2l0aElkZW50aXR5ID0gW21hdHJpeFRvQXBwbHldLmNvbmNhdChhcmdzKTtcbiAgbWF0cml4TWF0aEZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3NXaXRoSWRlbnRpdHkpO1xuICBNYXRyaXhNYXRoLm11bHRpcGx5SW50byhyZXN1bHQsIHJlc3VsdCwgbWF0cml4VG9BcHBseSk7XG59XG5cbi8qKlxuICogUGFyc2VzIGEgc3RyaW5nIGxpa2UgJzAuNXJhZCcgb3IgJzYwZGVnJyBpbnRvIHJhZGlhbnMgZXhwcmVzc2VkIGluIGEgZmxvYXQuXG4gKiBOb3RlIHRoYXQgdmFsaWRhdGlvbiBvbiB0aGUgc3RyaW5nIGlzIGRvbmUgaW4gYF92YWxpZGF0ZVRyYW5zZm9ybSgpYC5cbiAqL1xuZnVuY3Rpb24gX2NvbnZlcnRUb1JhZGlhbnModmFsdWU6IHN0cmluZyk6IG51bWJlciB7XG4gIGNvbnN0IGZsb2F0VmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgcmV0dXJuIHZhbHVlLmluZGV4T2YoJ3JhZCcpID4gLTEgPyBmbG9hdFZhbHVlIDogKGZsb2F0VmFsdWUgKiBNYXRoLlBJKSAvIDE4MDtcbn1cblxuZnVuY3Rpb24gX3ZhbGlkYXRlVHJhbnNmb3Jtcyh0cmFuc2Zvcm06IEFycmF5PE9iamVjdD4pOiB2b2lkIHtcbiAgdHJhbnNmb3JtLmZvckVhY2godHJhbnNmb3JtYXRpb24gPT4ge1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyh0cmFuc2Zvcm1hdGlvbik7XG4gICAgaW52YXJpYW50KFxuICAgICAga2V5cy5sZW5ndGggPT09IDEsXG4gICAgICAnWW91IG11c3Qgc3BlY2lmeSBleGFjdGx5IG9uZSBwcm9wZXJ0eSBwZXIgdHJhbnNmb3JtIG9iamVjdC4gUGFzc2VkIHByb3BlcnRpZXM6ICVzJyxcbiAgICAgIHN0cmluZ2lmeVNhZmUodHJhbnNmb3JtYXRpb24pLFxuICAgICk7XG4gICAgY29uc3Qga2V5ID0ga2V5c1swXTtcbiAgICBjb25zdCB2YWx1ZSA9IHRyYW5zZm9ybWF0aW9uW2tleV07XG4gICAgX3ZhbGlkYXRlVHJhbnNmb3JtKGtleSwgdmFsdWUsIHRyYW5zZm9ybWF0aW9uKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIF92YWxpZGF0ZVRyYW5zZm9ybShcbiAga2V5OlxuICAgIHwgc3RyaW5nXG4gICAgfCAkVEVNUE9SQVJZJHN0cmluZzwnbWF0cml4Jz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdwZXJzcGVjdGl2ZSc+XG4gICAgfCAkVEVNUE9SQVJZJHN0cmluZzwncm90YXRlJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdyb3RhdGVYJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdyb3RhdGVZJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdyb3RhdGVaJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdzY2FsZSc+XG4gICAgfCAkVEVNUE9SQVJZJHN0cmluZzwnc2NhbGVYJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdzY2FsZVknPlxuICAgIHwgJFRFTVBPUkFSWSRzdHJpbmc8J3NrZXdYJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdza2V3WSc+XG4gICAgfCAkVEVNUE9SQVJZJHN0cmluZzwndHJhbnNsYXRlJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCd0cmFuc2xhdGVYJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCd0cmFuc2xhdGVZJz4sXG4gIHZhbHVlOiBhbnkgfCBudW1iZXIgfCBzdHJpbmcsXG4gIHRyYW5zZm9ybWF0aW9uOiBhbnksXG4pIHtcbiAgaW52YXJpYW50KFxuICAgICF2YWx1ZS5nZXRWYWx1ZSxcbiAgICAnWW91IHBhc3NlZCBhbiBBbmltYXRlZC5WYWx1ZSB0byBhIG5vcm1hbCBjb21wb25lbnQuICcgK1xuICAgICAgJ1lvdSBuZWVkIHRvIHdyYXAgdGhhdCBjb21wb25lbnQgaW4gYW4gQW5pbWF0ZWQuIEZvciBleGFtcGxlLCAnICtcbiAgICAgICdyZXBsYWNlIDxWaWV3IC8+IGJ5IDxBbmltYXRlZC5WaWV3IC8+LicsXG4gICk7XG5cbiAgY29uc3QgbXVsdGl2YWx1ZVRyYW5zZm9ybXMgPSBbJ21hdHJpeCcsICd0cmFuc2xhdGUnXTtcbiAgaWYgKG11bHRpdmFsdWVUcmFuc2Zvcm1zLmluZGV4T2Yoa2V5KSAhPT0gLTEpIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBBcnJheS5pc0FycmF5KHZhbHVlKSxcbiAgICAgICdUcmFuc2Zvcm0gd2l0aCBrZXkgb2YgJXMgbXVzdCBoYXZlIGFuIGFycmF5IGFzIHRoZSB2YWx1ZTogJXMnLFxuICAgICAga2V5LFxuICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgKTtcbiAgfVxuICBzd2l0Y2ggKGtleSkge1xuICAgIGNhc2UgJ21hdHJpeCc6XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHZhbHVlLmxlbmd0aCA9PT0gOSB8fCB2YWx1ZS5sZW5ndGggPT09IDE2LFxuICAgICAgICAnTWF0cml4IHRyYW5zZm9ybSBtdXN0IGhhdmUgYSBsZW5ndGggb2YgOSAoMmQpIG9yIDE2ICgzZCkuICcgK1xuICAgICAgICAgICdQcm92aWRlZCBtYXRyaXggaGFzIGEgbGVuZ3RoIG9mICVzOiAlcycsXG4gICAgICAgIC8qICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXSAoPj0wLjg0LjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpIFRoaXNcbiAgICAgICAgICogY29tbWVudCBzdXBwcmVzc2VzIGFuIGVycm9yIGZvdW5kIHdoZW4gRmxvdyB2MC44NCB3YXMgZGVwbG95ZWQuIFRvXG4gICAgICAgICAqIHNlZSB0aGUgZXJyb3IsIGRlbGV0ZSB0aGlzIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICAgICAgICB2YWx1ZS5sZW5ndGgsXG4gICAgICAgIHN0cmluZ2lmeVNhZmUodHJhbnNmb3JtYXRpb24pLFxuICAgICAgKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3RyYW5zbGF0ZSc6XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHZhbHVlLmxlbmd0aCA9PT0gMiB8fCB2YWx1ZS5sZW5ndGggPT09IDMsXG4gICAgICAgICdUcmFuc2Zvcm0gd2l0aCBrZXkgdHJhbnNsYXRlIG11c3QgYmUgYW4gYXJyYXkgb2YgbGVuZ3RoIDIgb3IgMywgZm91bmQgJXM6ICVzJyxcbiAgICAgICAgLyogJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddICg+PTAuODQuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpc1xuICAgICAgICAgKiBjb21tZW50IHN1cHByZXNzZXMgYW4gZXJyb3IgZm91bmQgd2hlbiBGbG93IHYwLjg0IHdhcyBkZXBsb3llZC4gVG9cbiAgICAgICAgICogc2VlIHRoZSBlcnJvciwgZGVsZXRlIHRoaXMgY29tbWVudCBhbmQgcnVuIEZsb3cuICovXG4gICAgICAgIHZhbHVlLmxlbmd0aCxcbiAgICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgICApO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAncm90YXRlWCc6XG4gICAgY2FzZSAncm90YXRlWSc6XG4gICAgY2FzZSAncm90YXRlWic6XG4gICAgY2FzZSAncm90YXRlJzpcbiAgICBjYXNlICdza2V3WCc6XG4gICAgY2FzZSAnc2tld1knOlxuICAgICAgaW52YXJpYW50KFxuICAgICAgICB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnLFxuICAgICAgICAnVHJhbnNmb3JtIHdpdGgga2V5IG9mIFwiJXNcIiBtdXN0IGJlIGEgc3RyaW5nOiAlcycsXG4gICAgICAgIGtleSxcbiAgICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgICApO1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICB2YWx1ZS5pbmRleE9mKCdkZWcnKSA+IC0xIHx8IHZhbHVlLmluZGV4T2YoJ3JhZCcpID4gLTEsXG4gICAgICAgICdSb3RhdGUgdHJhbnNmb3JtIG11c3QgYmUgZXhwcmVzc2VkIGluIGRlZ3JlZXMgKGRlZykgb3IgcmFkaWFucyAnICtcbiAgICAgICAgICAnKHJhZCk6ICVzJyxcbiAgICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgICApO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAncGVyc3BlY3RpdmUnOlxuICAgICAgaW52YXJpYW50KFxuICAgICAgICB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInLFxuICAgICAgICAnVHJhbnNmb3JtIHdpdGgga2V5IG9mIFwiJXNcIiBtdXN0IGJlIGEgbnVtYmVyOiAlcycsXG4gICAgICAgIGtleSxcbiAgICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgICApO1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICB2YWx1ZSAhPT0gMCxcbiAgICAgICAgJ1RyYW5zZm9ybSB3aXRoIGtleSBvZiBcIiVzXCIgY2Fubm90IGJlIHplcm86ICVzJyxcbiAgICAgICAga2V5LFxuICAgICAgICBzdHJpbmdpZnlTYWZlKHRyYW5zZm9ybWF0aW9uKSxcbiAgICAgICk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICd0cmFuc2xhdGVYJzpcbiAgICBjYXNlICd0cmFuc2xhdGVZJzpcbiAgICBjYXNlICdzY2FsZSc6XG4gICAgY2FzZSAnc2NhbGVYJzpcbiAgICBjYXNlICdzY2FsZVknOlxuICAgICAgaW52YXJpYW50KFxuICAgICAgICB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInLFxuICAgICAgICAnVHJhbnNmb3JtIHdpdGgga2V5IG9mIFwiJXNcIiBtdXN0IGJlIGEgbnVtYmVyOiAlcycsXG4gICAgICAgIGtleSxcbiAgICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgICApO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIGludmFyaWFudChcbiAgICAgICAgZmFsc2UsXG4gICAgICAgICdJbnZhbGlkIHRyYW5zZm9ybSAlczogJXMnLFxuICAgICAgICBrZXksXG4gICAgICAgIHN0cmluZ2lmeVNhZmUodHJhbnNmb3JtYXRpb24pLFxuICAgICAgKTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHByb2Nlc3NUcmFuc2Zvcm07XG4iXSwibWFwcGluZ3MiOiJBQVVBLFlBQVk7O0FBRVosSUFBTUEsVUFBVSxHQUFHQyxPQUFPLDJCQUEyQjtBQUNyRCxJQUFNQyxRQUFRLEdBQUdELE9BQU8seUJBQXlCO0FBRWpELElBQU1FLFNBQVMsR0FBR0YsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUN0QyxJQUFNRyxhQUFhLEdBQUdILE9BQU8sOEJBQThCLFdBQVE7QUFVbkUsU0FBU0ksZ0JBQWdCLENBQ3ZCQyxTQUF3QixFQUNPO0VBQy9CLElBQUlDLE9BQU8sRUFBRTtJQUNYQyxtQkFBbUIsQ0FBQ0YsU0FBUyxDQUFDO0VBQ2hDO0VBS0EsSUFBSUosUUFBUSxDQUFDTyxFQUFFLEtBQUssU0FBUyxJQUFJUCxRQUFRLENBQUNPLEVBQUUsS0FBSyxLQUFLLEVBQUU7SUFDdEQsT0FBT0gsU0FBUztFQUNsQjtFQUVBLElBQU1JLE1BQU0sR0FBR1YsVUFBVSxDQUFDVyxvQkFBb0IsRUFBRTtFQUVoREwsU0FBUyxDQUFDTSxPQUFPLENBQUMsVUFBQUMsY0FBYyxFQUFJO0lBQ2xDLElBQU1DLEdBQUcsR0FBR0MsTUFBTSxDQUFDQyxJQUFJLENBQUNILGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMxQyxJQUFNSSxLQUFLLEdBQUdKLGNBQWMsQ0FBQ0MsR0FBRyxDQUFDO0lBRWpDLFFBQVFBLEdBQUc7TUFDVCxLQUFLLFFBQVE7UUFDWGQsVUFBVSxDQUFDa0IsWUFBWSxDQUFDUixNQUFNLEVB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